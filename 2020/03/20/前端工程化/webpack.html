<h2 id="webpack-概述"><a href="#webpack-概述" class="headerlink" title="webpack 概述"></a>webpack 概述</h2><ul>
<li>webpack 是一个流行的前端项目构建工具（打包工具），可以解决当前 web 开发中所面临的困境。</li>
<li>webpack 提供了友好的模块化支持，以及代码压缩混淆、处理 js 兼容问题、性能优化等强大的功能，从而让程序员把工作的重心放到具体的功能实现上，提高了开发效率和项目的可维护性。</li>
</ul>
<h2 id="webpack-的基本使用"><a href="#webpack-的基本使用" class="headerlink" title="webpack 的基本使用"></a>webpack 的基本使用</h2><h3 id="在项目中安装和配置-webpack"><a href="#在项目中安装和配置-webpack" class="headerlink" title="在项目中安装和配置 webpack"></a>在项目中安装和配置 webpack</h3><pre><code>注意：
npm i module_name -S 也就是（npm install module_name --save）的简写，它是把安装包的名称和版本号存到到dependencies中，
npm i module_name -D 也就是*（npm install module_nam --save-dev）的简写，它是把安装包的名称和版本号存到devDependencies中，</code></pre><ol>
<li><p>运行如下命令，安装 webpack 相关的包</p>
<pre><code>npm install webpack webpack-cli –D</code></pre></li>
<li><p>在项目根目录中，创建名为 webpack.config.js 的 webpack 配置文件</p>
</li>
<li><p>在 webpack 的配置文件中初始化如下基本配置</p>
<pre><code class="js"><span class="built_in">module</span>.exports = {
  mode: <span class="string">"development"</span>
};</code></pre>
<ul>
<li>mode 选项：可以设置为 development(开发模式)，production(发布模式)</li>
</ul>
</li>
<li><p>在 package.json 配置文件中的 scripts 节点下新增如下 dev 脚本</p>
<pre><code class="json">&quot;scripts&quot;:{
    &quot;dev&quot;:&quot;webpack&quot;
}</code></pre>
</li>
<li><p>在项目根目录下运行 npm run dev 命令，启动 webpack 进行项目打包</p>
<ul>
<li>运行完以后，会产生一个 dist 目录，里面包含着转换完成的文件<br><img src="%E8%BF%90%E8%A1%8Cwebpack.png" alt=""><br><img src="%E8%BF%90%E8%A1%8Cwebpack%E5%90%8E%E7%9A%84%E7%9B%AE%E5%BD%95.png" alt=""></li>
</ul>
</li>
</ol>
<h3 id="配置打包的入口和出口"><a href="#配置打包的入口和出口" class="headerlink" title="配置打包的入口和出口"></a>配置打包的入口和出口</h3><p>在 webpack4.*版本中，默认入口文件是 src/index.js，输出文件是 dist/main.js</p>
<ul>
<li>如果要修改的话，可以在 webpack.config.js 文件中新增如下配置信息<pre><code class="js"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">"path"</span>);
<span class="built_in">module</span>.exports = {
  mode: <span class="string">"development"</span>,
  entry: path.join(__dirname, <span class="string">"./src/xx.js"</span>),
  output: {
    path: path.join(__dirname, <span class="string">"./dist"</span>),
    filename: <span class="string">"res.js"</span>
  }
};</code></pre>
<ul>
<li>entry: 设置入口文件路径</li>
<li>output: 设置出口文件<ul>
<li>path: 设置路径</li>
<li>filename: 设置文件名</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="配置-webpack-自动打包"><a href="#配置-webpack-自动打包" class="headerlink" title="配置 webpack 自动打包"></a>配置 webpack 自动打包</h3><ol>
<li>安装支持仙姑自动打包的工具<pre><code>npm install webpack-dev-server -D</code></pre></li>
<li>修改 package.json 里的 scripts 节点中的 dev 命令<pre><code class="json">&quot;scripts&quot;:{
   &quot;dev&quot;:&quot;webpack-dev-server&quot;
 }</code></pre>
</li>
<li>将 index.html 中的 script 属性 src 修改为/bundle.js</li>
<li>运行 npm run dev 命令</li>
<li>在浏览器中访问<a href="http://localhost:8080" target="_blank" rel="noopener">http://localhost:8080</a></li>
</ol>
<h3 id="配置-html-webpack-plugin-生成预览页面"><a href="#配置-html-webpack-plugin-生成预览页面" class="headerlink" title="配置 html-webpack-plugin 生成预览页面"></a>配置 html-webpack-plugin 生成预览页面</h3><ol>
<li><p>安装插件</p>
<pre><code>npm install html-webpack-plugin -D</code></pre></li>
<li><p>修改 webpack.config.js 文件，添加配置</p>
<pre><code class="js"><span class="comment">//导入包</span>
<span class="keyword">const</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">"html-webpack-plugin"</span>);
<span class="comment">//创建对象</span>
<span class="keyword">const</span> htmlPlugin = <span class="keyword">new</span> HtmlWebpackPlugin({
  <span class="comment">//设置生成预览页面的模板文件</span>
  template: <span class="string">"./src/index.html"</span>,
  <span class="comment">//设置生成的预览页面名称</span>
  filename: <span class="string">"index.html"</span>
});</code></pre>
</li>
<li><p>修改 webpack.config.js，添加向外暴露的对象</p>
<pre><code class="js"><span class="built_in">module</span>.exports = {
  plugins: [htmlPlugin]
};</code></pre>
<ul>
<li>plugin 数组是 webpack 打包期间会用到的插件列表</li>
</ul>
</li>
</ol>
<h3 id="自动打开浏览器页面"><a href="#自动打开浏览器页面" class="headerlink" title="自动打开浏览器页面"></a>自动打开浏览器页面</h3><p>在 package.json 中的修改如下配置</p>
<pre><code class="json"><span class="comment">//</span>
"scripts": {
  "dev": "webpack-dev-server --open --host 127.0.0.1 --port 9999"
}</code></pre>
<ul>
<li>–open 打包完成后自动打开页面</li>
<li>–host 配置 ip 地址</li>
<li>–port 配置端口</li>
</ul>
<h2 id="webpack-中的加载器"><a href="#webpack-中的加载器" class="headerlink" title="webpack 中的加载器"></a>webpack 中的加载器</h2><p>在实际开发过程中，webpack 默认只能打包处理以 .js 后缀名结尾的模块，其他非 .js 后缀名结 尾的模块，webpack 默认处理不了，需要调用 loader 加载器才可以正常打包，否则会报错！</p>
<p>例如 import css 文件不使用 loader 处理就报错了<br><img src="loader%E6%8A%A5%E9%94%99.png" alt="loader报错"></p>
<ul>
<li>loader 加载器可以协助 webpack 打包处理特定的文件模块，比如：<ul>
<li>less-loader 可以打包处理 .less 相关的文件</li>
<li>sass-loader 可以打包处理 .scss 相关的文件</li>
<li>url-loader 可以打包处理 css 中与 url 路径相关的文件</li>
</ul>
</li>
</ul>
<p><img src="loader%E7%9A%84%E8%B0%83%E7%94%A8%E8%BF%87%E7%A8%8B.png" alt="loader的调用过程"></p>
<h3 id="打包处理-css-文件"><a href="#打包处理-css-文件" class="headerlink" title="打包处理 css 文件"></a>打包处理 css 文件</h3><ol>
<li>安装 css 的 loader<pre><code>npm install style-loader css-loader -D</code></pre></li>
<li>在 webpack.config.js 的 module 对象的 rules 数组中添加 loader 规则<pre><code class="js"><span class="comment">// 所有第三方文件模块的匹配规则</span>
<span class="built_in">module</span>: {
  rules: [
    {
      <span class="comment">//test设置需要匹配的文件类型，支持正则</span>
      test: <span class="regexp">/\.css$/</span>,
      <span class="comment">//use表示该文件类型需要调用的loader</span>
      use: [<span class="string">"style-loader"</span>, <span class="string">"css-loader"</span>]
    }
  ];
}</code></pre>
<ul>
<li>注意：use 数组中指定的 loader 是顺序敏感的，顺序是<strong>从后往前</strong>调用</li>
</ul>
</li>
</ol>
<h3 id="打包处理-less-文件"><a href="#打包处理-less-文件" class="headerlink" title="打包处理 less 文件"></a>打包处理 less 文件</h3><ol>
<li>安装依赖包 注意：要像 less-loader 正常工作 必须要先安装 less<pre><code>npm install less-loader less -D
···</code></pre></li>
<li>添加 loader 规则<pre><code class="js"><span class="built_in">module</span>: {
  rules: [
    {
      test: <span class="regexp">/\.less$/</span>,
      use: [<span class="string">"style-loader"</span>, <span class="string">"css-loader"</span>, <span class="string">"less-loader"</span>]
    }
  ];
}</code></pre>
<ul>
<li>再次强调 use 里调用 loader 的顺序不能乱动，less 文件必须掀先转换成 css 文件才能被 cssloader 处理</li>
</ul>
</li>
</ol>
<h3 id="打包处理-scss-文件"><a href="#打包处理-scss-文件" class="headerlink" title="打包处理 scss 文件"></a>打包处理 scss 文件</h3><ol>
<li>安装依赖包(别忘了装 scss)<pre><code>npm install sass-loader node-sass -D</code></pre></li>
<li>添加 loader 规则<pre><code class="js"><span class="built_in">module</span>: {
  rules: [
    {
      test: <span class="regexp">/\.scss$/</span>,
      use: [<span class="string">"style-loader"</span>, <span class="string">"css-loader"</span>, <span class="string">"sass-loader"</span>]
    }
  ];
}</code></pre>
</li>
</ol>
<h3 id="配置-postCSS-自动添加-CSS-的兼容前缀"><a href="#配置-postCSS-自动添加-CSS-的兼容前缀" class="headerlink" title="配置 postCSS 自动添加 CSS 的兼容前缀"></a>配置 postCSS 自动添加 CSS 的兼容前缀</h3><p>例如::placehoder 伪元素就需要不同的浏览器前缀</p>
<ol>
<li>安装 loader 和 loader 的依赖项<pre><code>npm install postcss-loader autoprefixer -D</code></pre></li>
<li>在项目根目录中创建 postcss 的配置文件 postcss.config.js，并初始化如下配置<pre><code class="js"><span class="keyword">const</span> autoprefixer = <span class="built_in">require</span>(<span class="string">"autoprefixer"</span>);
<span class="built_in">module</span>.exports = {
  plugins: [autoprefixer]
};</code></pre>
</li>
<li>在 webpack.config.js 中修改 css 的 loader 规则（直接添加在 css 的规则里就行）<pre><code class="js"><span class="built_in">module</span>: {
  rules: [
    {
      test: <span class="regexp">/\.css$/</span>,
      use: [<span class="string">"style-loader"</span>, <span class="string">"css-loader"</span>, <span class="string">"postcss-loader"</span>]
    }
  ];
}</code></pre>
</li>
</ol>
<h3 id="打包样式表中的图片和字体文件"><a href="#打包样式表中的图片和字体文件" class="headerlink" title="打包样式表中的图片和字体文件"></a>打包样式表中的图片和字体文件</h3><p>如果有图片和字体文件且未经打包会报错<br><img src="%E5%9B%BE%E7%89%87%E4%B8%8D%E6%89%93%E5%8C%85%E6%8A%A5%E9%94%99.png" alt=""></p>
<ol>
<li>安装 loader<pre><code>npm install url-loader file-loader -D</code></pre></li>
<li>添加 loader 规则<pre><code class="js"><span class="built_in">module</span>: {
  rules: [
    {
      test: <span class="regexp">/\.jpg|png|gif|bmp|ttf|eot|svg|woff|woff2$/</span>,
      <span class="comment">//limit用来设置字节数，只有小于limit值的图片，才会转换</span>
      <span class="comment">//为base64图片</span>
      use: <span class="string">"url-loader?limit=16940"</span>
    }
  ];
}</code></pre>
<ul>
<li>?之后是 loader 的参数项</li>
<li>limit 用来指定图片的大小，单位是 byte，只有 size 小于 limit 的图片才会被转换成 base64 图片</li>
</ul>
</li>
</ol>
<h3 id="打包处理-js-的高级语法"><a href="#打包处理-js-的高级语法" class="headerlink" title="打包处理 js 的高级语法"></a>打包处理 js 的高级语法</h3><p>还是报错哈：</p>
<pre><code>ERROR in ./src/index.js 12:14
Module parse failed: Unexpected token (12:14)
You may need an appropriate loader to handle this file type, currently no loaders are configured to process this file. See https://webpack.js.org/concepts##loaders
|
| class Person {
&gt;   static info = &quot;aaa&quot;;
| }</code></pre><ol>
<li>安装 babel 转换器相关的包<pre><code>npm install babel-loader @babel/core @babel/runtime -D</code></pre></li>
<li>安装 babel 语法插件相关的包<pre><code>npm install @babel/preset-env @babel/plugin-transform-runtime @babel/plugin-proposal-class-properties -D</code></pre></li>
<li>在项目根目录中创建 babel 配置文件 babel.config.js<pre><code class="js"><span class="built_in">module</span>.exports = {
  presets: [<span class="string">"@babel/preset-env"</span>],
  plugins: [
    <span class="string">"@babel/plugin-transform-runtime"</span>,
    <span class="string">"@babel/plugin-proposal-class-properties"</span>
  ]
};</code></pre>
<ul>
<li>presets 属性里放语法相关的包的数组</li>
<li>plugins 属性里放插件数组</li>
</ul>
</li>
<li>在 webpack.config.js 中新增 loader 规则<pre><code class="js"><span class="built_in">module</span>: {
  rules: [
    {
      test: <span class="regexp">/\.js$/</span>,
      use: <span class="string">"babel-loader"</span>,
      <span class="comment">//exclude为排除项，意思是不要处理node_modules中的js文件</span>
      exclude: <span class="regexp">/node_modules/</span>
    }
  ];
}</code></pre>
</li>
</ol>
